<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="Receive SMS from SIM900A Kit using Arduino" />
        <meta name="author" content="Md. Minhazul Haque">
        <title>
        Receive SMS from SIM900A Kit using Arduino | 
        
        Minhaz Blog
        </title>
        <link rel="icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+Bengali&family=Ubuntu&display=swap" rel="stylesheet">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.5.1/build/styles/default.min.css">
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.5.1/build/highlight.min.js"></script>
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9642838276352812" crossorigin="anonymous"></script>
        <style>
        body {
            font-family: 'Ubuntu', 'Noto Serif Bengali', serif !important;
        }
        </style>
    </head>
    <body class="">
        <nav class="navbar navbar-expand-lg sticky-top navbar-dark bg-dark">
            <div class="container">
                <a class="navbar-brand" href="/blog">Minhaz Blog</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                        
                        <li class="nav-item"><a class="nav-link" href="https://github.com/mdminhazulhaque">Github</a></li>
                        
                        <li class="nav-item"><a class="nav-link" href="https://www.linkedin.com/in/mdminhazulhaque/">LinkedIn</a></li>
                        
                    </ul>
                </div>
            </div>
        </nav>
        <div class="container mt-4">
            <div class="row">
                <div class="col-lg-9">
                    

<article>
    <header class="mb-4">
        <h1 class="fw-bolder mb-1">Receive SMS from SIM900A Kit using Arduino</h1>
        <div class="text-muted fst-italic mb-2">Posted on 09 Jun, 2016 in hardware</div>
    </header>
    <section class="mb-5">

<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-9642838276352812"
     data-ad-slot="8038474176"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
<br>

        <p>Sending SMS through SIM900A Kit is quite easy. You just need to turn on text based composition mode, write the text and send 0x1a. Here is an example. Note that SIM900A is an instance of <code>SoftwareSerial</code> class connected via Serial interface of the Arduino.</p>
<pre><code class="language-cpp">String number = &quot;+880123456789&quot;;
String content = &quot;Hello, World!&quot;;

SIM900A.println(&quot;AT+CMGF=1&quot;); // Turn on plain text mode
SIM900A.println(&quot;AT+CMGS=\&quot;&quot; + number + &quot;\&quot;\r&quot;);
SIM900A.println(content);
SIM900A.println((char)26); // Done
</code></pre>
<p>But when it comes to the point of receiving SMS, what to do? I had to read the SIM900A AT Command list and found out a perfect solution. By default, upon receiving SMS, the SIM900A Kit prints a string that contains information like index of the SMS, sender number, timestamp etc. Then you'll have to type <code>AT+CMGR=1</code> (where 1 is the index number of SMS) to read a specific SMS from memory and <code>AT+CMGD=1</code> to delete the SMS. List of all SMS can be seen using <code>AT+CMGL="ALL"</code> command.</p>
<p>The solution I found is, turning on SMS buffer to TE (Terminal Equipment) so whenever any SMS is received, the content is forwarded directly to the TE. To do so, you'll need to set CNMI flag like the following.</p>
<pre><code class="language-cpp">SIM900A.println(&quot;AT+CNMI=2,2,0,0,0&quot;);
</code></pre>
<p>After turning on the CNMI mode to buffer all SMS content to terminal, the following strings were found in the serial interface.</p>
<pre><code>
+CMT: &quot;+880123456789&quot;,&quot;&quot;,&quot;16/05/24,07:40:32+24&quot;
Hello there, this is test message.


+CMT: &quot;+880123456789&quot;,&quot;&quot;,&quot;16/05/24,07:40:39+12&quot;
Hello there, this is another test message.

</code></pre>
<p>Note that each serial event is prefixed and postfixed by <code>\r\n</code> instead of simple <code>\n</code>.</p>
<p>I wrote up a function that reads each serial event of SIM900A into a string. This will help us to clip, remove or split strings according to our needs.</p>
<pre><code class="language-cpp">String readSIM900A()
{
    String buffer;

    while (SIM900A.available())
    {
        char c = SIM900A.read();
        buffer.concat(c);
        delay(10);
    }

    return buffer;
}
</code></pre>
<p>I know this is not so memory efficient, but it gets the job done, right? Well, let's use this function for detecting incoming SMS events from SIM900A serial data.</p>
<pre><code class="language-cpp">void setup()
{
    Serial.begin(9600);
    SIM900A.begin(9600);
}

void loop()
{
    String buffer = readSIM900A();

    if (buffer.startsWith(&quot;\r\n+CMT: &quot;))
    {
        Serial.println(&quot;*** RECEIVED A SMS ***&quot;);
    }

    delay(100);
}
</code></pre>
<p>So the incoming SMS event can be detected. Now let's parse the buffer variable to get the content of the SMS.</p>
<p>This is the pattern of incoming SMS notification from SIM900A.</p>
<pre><code>\r\n+CMT: &quot;SENDER NUMBER&quot;,&quot;&quot;,&quot;yy/mm/dd,hh:mm:ss+ms&quot;\r\nSMS BODY\r\n
</code></pre>
<p>Now it is obvious that,</p>
<ul>
<li>Length of phone number <code>+880123456789</code> is 13</li>
<li>Length of header <code>\r\n+CMT: "","","yy/mm/dd,hh:mm:ss+ms"\r\n</code> is 38</li>
</ul>
<p>So if we skip first 13+38 = 51 characters from <code>buffer</code> object, we will get the SMS body. Again, we need to clip last 2 characters because they will contain <code>\r\n</code>. So let's rewrite the <code>loop()</code> function like the following.</p>
<pre><code class="language-cpp">void loop()
{
    String buffer = readSIM900A();

    if (buffer.startsWith(&quot;\r\n+CMT: &quot;))
    {
        Serial.println(&quot;*** RECEIVED SMS ***&quot;);

        // Remove first 51 characters
        buffer.remove(0, 51);
        int len = buffer.length();
        // Remove \r\n from tail
        buffer.remove(len - 2, 2);

        Serial.println(buffer);

        Serial.println(&quot;*** END SMS ***&quot;);
    }

    delay(100);
}
</code></pre>
<p>Now send SMS to SIM900A kit and SMS contents should appear like the following.</p>
<pre><code>*** RECEIVED SMS ***
Hello there, this is test message.
*** END SMS ***
*** RECEIVED SMS ***
Hello there, this is another test message.
*** END SMS ***
</code></pre>
<p>I hope that is enough. If you think you got a better method to achieve this, feel free to share in the comment box. :)</p>
<p>Good luck with your SIM900A exploring project!</p>

<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-9642838276352812"
     data-ad-slot="8294162148"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

        <script>hljs.highlightAll();</script>
    </section>
</article>
<!-- Comments section-->
<section class="mb-5">
    <div class="card bg-light">
        <div class="card-body">
            <div id="disqus_thread"></div>
            <script type="text/javascript">
            (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;	
            dsq.src = 'https://bitsfromminhaz.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);	
            })();
            </script>
        </div>
    </div>
</section>

                </div>
                <div class="col-lg-3">
                    <div class="card mb-4">
                        <div class="card-header">Categories</div>
                        <ul class="list-group list-group-flush">
                        
                            <a class="list-group-item d-flex justify-content-between align-items-start" href="/blog/linux">
                                linux
                                <span class="badge text-bg-dark">30</span>
                            </a>
                        
                            <a class="list-group-item d-flex justify-content-between align-items-start" href="/blog/snippets">
                                snippets
                                <span class="badge text-bg-dark">29</span>
                            </a>
                        
                            <a class="list-group-item d-flex justify-content-between align-items-start" href="/blog/malaysia">
                                malaysia
                                <span class="badge text-bg-dark">9</span>
                            </a>
                        
                            <a class="list-group-item d-flex justify-content-between align-items-start" href="/blog/macos">
                                macos
                                <span class="badge text-bg-dark">7</span>
                            </a>
                        
                            <a class="list-group-item d-flex justify-content-between align-items-start" href="/blog/android">
                                android
                                <span class="badge text-bg-dark">7</span>
                            </a>
                        
                            <a class="list-group-item d-flex justify-content-between align-items-start" href="/blog/qt">
                                qt
                                <span class="badge text-bg-dark">5</span>
                            </a>
                        
                            <a class="list-group-item d-flex justify-content-between align-items-start" href="/blog/hardware">
                                hardware
                                <span class="badge text-bg-dark">5</span>
                            </a>
                        
                            <a class="list-group-item d-flex justify-content-between align-items-start" href="/blog/openwrt">
                                openwrt
                                <span class="badge text-bg-dark">4</span>
                            </a>
                        
                            <a class="list-group-item d-flex justify-content-between align-items-start" href="/blog/database">
                                database
                                <span class="badge text-bg-dark">1</span>
                            </a>
                        
                            <a class="list-group-item d-flex justify-content-between align-items-start" href="/blog/aws">
                                aws
                                <span class="badge text-bg-dark">1</span>
                            </a>
                        
                            <a class="list-group-item d-flex justify-content-between align-items-start" href="/blog/kubernetes">
                                kubernetes
                                <span class="badge text-bg-dark">1</span>
                            </a>
                        
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <footer class="py-5 bg-dark">
            <div class="container"><p class="m-0 text-center text-white">Copyright &copy; Md. Minhazul Haque 2012-2022</p></div>
        </footer>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js"></script>
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-57632461-1"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-57632461-1');
        </script>
    </body>
</html>
